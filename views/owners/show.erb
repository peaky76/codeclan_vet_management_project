<div class="content-top">
    <header>
        <h1><%= @owner.full_name %><sup class="id-sup"> (ID: <%= @owner.id %>)</sup></h1>
        <em>
            <% for element in @owner.full_address %>
                <%= element %><br/>
            <% end %>
        </em>
        <p><%= @owner.tel %></p>
        <p>Balance due: Â£<%= sprintf('%.2f', @owner.balance_due) %>
    </header>

    <section class="button-row">
            <form class="btn-route" action="/owners/<%= @owner.id %>/edit" method="GET"><input type="submit" value="Edit details"></form>
            <form class="btn-route" action="/pets/new" method="GET">
                <input type="hidden" name="owner_id" value="<%= @owner.id %>">
                <input type="submit" value="Add pet">
            </form>
            <form class="btn-route" action="/owners/<%= @owner.id %>/delete" method="POST"><input type="submit" value="Delete"></form>
    </section>
</div>

<div class="content-bottom">
    <section>
        <h2>Pets</h2>

        <ul>
            <% for pet in @owner.pets %>
                <li><a href="/pets/<%= pet.id %>"><%= pet.name %></a> | <%= pet.type %></li>
            <% end %>
            <% if @owner.pets.count == 0 %>
                <em>No pets assigned</em>
            <% end %>              
        </ul>
    </section>

    <section>
        <h2>Billings</h2>

        <% if @owner.purchases.count > 0 %>
            <ul>
            <% for purchase in @owner.purchases.to_chron_order %>
                <li>
                <%= purchase.pretty_date %> | 
                <%= purchase.description %> | 
                <%= purchase.cost.to_currency %> 
                </li>
            <% end %>
            </ul>
        <% else %>
            No billings yet.
        <% end %>

        TOTAL: <%= @owner.total_billed.to_currency %>
    </section>

    <section>
        <h2>Payments</h2>

        <ul>
        <% for payment in @owner.payments %>
            <li><%= payment.pretty_date %> | <%= payment.amount.to_currency %></li>
        <% end %>
        <% if @owner.payments.count == 0 %>
            <em>No payments made yet.</em>
        <% end %>
        </ul>

        TOTAL: <%= @owner.total_paid.to_currency %>
    </section>
   
</div>
